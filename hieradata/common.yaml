---
role::default_profiles:
  - default

profile::default::includes:
  - component::apt

profile::default::components:
  - sysctl
  - users
  - network
  - resolvconf
  - fail2ban
  - packages
  - collectd

component::apt::repos:
  - puppetlabs
  - freifunk

component::apt::ubuntu::mirror: mirror.lrz.de
component::apt::ubuntu::utopic::mirror: mirror.lrz.de

component::packages::names:
  - htop
  - iftop
  - molly-guard
  - ethtool
  - nmon
  - iotop
  - memlockd
  - strace
  - tcpdump
  - dstat

apt::purge:
  sources.list: true
  sources.list.d: true

component::resolvconf::nameservers:
  - 213.73.91.35

component::resolvconf::template: |
  # Generated by puppet
  # all manual changes will be LOST!
  domain <%= @domain %>
  search <%= @domain %>

  <% @nameservers.sort.each do |ns| -%>
  nameserver <%= ns %>
  <% end -%>

fail2ban::bantime: 900
fail2ban::findtime: 600
fail2ban::maxretry: 3

chrony::servers: [ 'de.pool.ntp.org' ]
chrony::serve_ntp: true
chrony::client_allow: [ '10.120.0.0/16', 'fdef:ffc0:4ffa::/48' ]

collectd::purge: true
collectd::purge_config: true
collectd::recurse: true
collectd::interval: 30

component::collectd::plugin_classes:
  - syslog
  - cpu
  - df
  - disk
  - entropy
  - interface
  - load
  - memory
  - processes
  - swap
  - users
  - write_graphite

collectd::plugin::df::ignoreselected: true
collectd::plugin::df::fstypes:
  - rootfs
  - sysfs
  - proc
  - devtmpfs
  - devpts
  - fusectl
  - cgroup
  - tmpfs
  - vboxsf

collectd::plugin::write_graphite::carbon_defaults:
  protocol: tcp
  storerates: true
  graphiteprefix: 'servers.'
